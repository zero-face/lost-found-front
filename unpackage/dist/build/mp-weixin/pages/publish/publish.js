(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/publish/publish"],{"495e":function(e,n,t){"use strict";t.r(n);var o=t("ad3c"),r=t("6ce8");for(var i in r)"default"!==i&&function(e){t.d(n,e,(function(){return r[e]}))}(i);var u,s=t("f0c5"),c=Object(s["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);n["default"]=c.exports},"6ce8":function(e,n,t){"use strict";t.r(n);var o=t("a42a"),r=t.n(o);for(var i in o)"default"!==i&&function(e){t.d(n,e,(function(){return o[e]}))}(i);n["default"]=r.a},a42a:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=r(t("a34a"));function r(e){return e&&e.__esModule?e:{default:e}}function i(e,n,t,o,r,i,u){try{var s=e[i](u),c=s.value}catch(a){return void t(a)}s.done?n(c):Promise.resolve(c).then(o,r)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(o,r){var u=e.apply(n,t);function s(e){i(u,o,r,s,c,"next",e)}function c(e){i(u,o,r,s,c,"throw",e)}s(void 0)}))}}var s={data:function(){return{action:"http://123.57.220.238:8888/api/v1/lost/upload",pictureUrl:"",params:{year:!0,month:!0,day:!0,hour:!0,minute:!0,second:!1},token:"",fileList:[],list:["失物","寻物"],meslist:["请注意：失物发布和寻物发布使用同一个表单，失物发布必须上传照片，寻物发布可以不用上传照片，寻物失物的发布都代表本人，一旦发布认定丢失（寻找人）都是发布者"],background:{backgroundImage:"linear-gradient(45deg, rgb(28, 187, 180), rgb(141, 198, 63))"},current:0,form:{name:"",des:"",time:"",type:0,address:""},selectedTime:"",show:!1,shows:!1,errorType:["message","border-bottom"],rules:{name:[{required:!0,message:"必填字段",trigger:["blur","change"]}],des:[{required:!0,message:"必填字段",min:5,max:30,trigger:["blur","change"]}],time:[{required:!0,message:"必填字段",trigger:["blur","change"]}],address:[{required:!0,message:"必填字段",trigger:["blur","change"]}]}}},computed:{isPub:function(){return this.$store.state.isPub},type:function(){return this.$store.state.type},userInfo:function(){return this.$store.state.userInfo},isExpired:function(){return this.$store.state.isExpired}},onShow:function(){},onReady:function(){},onLoad:function(){var n=e.getStorageSync("token"),t=this.$userInfo.getUsername();void 0!=n?(this.$store.dispatch("checkToken",[n,t]),this.$store.dispatch("getType")):this.$store.state.isExpired=!1},methods:{errorUpload:function(e,n,t,o){console.log(e)},successUpload:function(n,t,o,r){"success"==n.status?(this.pictureUrl=n.data,e.showToast({title:"图片上传成功",icon:"success"})):(this.pictureUrl="",e.showToast({title:"图片上传失败",icon:"error"}))},selectTime:function(e){this.form.time=e.year+"-"+e.month+"-"+e.day+" "+e.hour+":"+e.minitue+":"+e.second,this.selectedTime=e.year+"年"+e.month+"月"+e.day+"日"+e.hour+"时"+e.minute+"分",this.shows=!1},showTime:function(){this.shows=!0},submit:function(n,t,r){var i=this;return u(o.default.mark((function u(){return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:console.log("开始验证"),i.$refs.uForm.validate((function(o){o?(console.log("验证通过"),"0"==i.current?null!=i.pictureUrl&&i.pictureUrl.length>0?(i.$store.commit("submitLoss",[i.form.time,t,i.form.name,i.pictureUrl,i.form.address,n,i.form.des]),1==r?(i.clear(),r=!1,console.log("发布成功")):console.log("发布失败")):(e.showToast({title:"图片上传失败",icon:"warning"}),setTimeout((function(){e.hideToast()}),1e3)):(console.log("发布寻物"),console.log(t),i.$store.dispatch("submitFound",[i.form.time,t,i.form.name,i.pictureUrl,i.form.address,n,i.form.des]),r?(i.clear(),r=!1,console.log("发布成功")):console.log("发布失败"))):console.log("验证失败")}));case 2:case"end":return o.stop()}}),u)})))()},confir:function(e){this.index=e[0],this.form.type=e[0]},clicki:function(){this.show=!0},sectionChange:function(e){this.current=e,this.clear()},clear:function(){this.form.time="",this.form.name="",this.pictureUrl="",this.form.address="",this.form.type=0,this.selectedTime="",this.form.des=""}}};n.default=s}).call(this,t("543d")["default"])},ad3c:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return o}));var o={uNavbar:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-navbar/u-navbar")]).then(t.bind(null,"c76d"))},uNoticeBar:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-notice-bar/u-notice-bar")]).then(t.bind(null,"86bf"))},uSubsection:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-subsection/u-subsection")]).then(t.bind(null,"0b2d"))},"u-Form":function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u--form/u--form")]).then(t.bind(null,"34ee"))},uFormItem:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-form-item/u-form-item")]).then(t.bind(null,"0f6c"))},uInput:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-input/u-input")]).then(t.bind(null,"50ee"))},uPicker:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-picker/u-picker")]).then(t.bind(null,"34ca"))},uButton:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-button/u-button")]).then(t.bind(null,"6041"))},uUpload:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui_2.0.4/components/u-upload/u-upload")]).then(t.bind(null,"553b"))}},r=function(){var e=this,n=e.$createElement;e._self._c},i=[]},d8ba:function(e,n,t){"use strict";(function(e){t("1a67");o(t("66fd"));var n=o(t("495e"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=t,e(n.default)}).call(this,t("543d")["createPage"])}},[["d8ba","common/runtime","common/vendor"]]]);